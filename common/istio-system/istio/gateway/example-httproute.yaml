---
# Example HTTPRoute configuration
# This demonstrates how to route traffic from the external gateway to your applications
#
# Usage: Copy this file to your application directory and modify:
# 1. Change namespace to match your app namespace
# 2. Update hostnames to match your domains
# 3. Update backendRefs to point to your service
#
# The gateway is deployed on the Hetzner control plane and accessible via:
# - HTTP: http://<hetzner-node-ip>:30080
# - HTTPS: http://<hetzner-node-ip>:30443
apiVersion: gateway.networking.k8s.io/v1
kind: HTTPRoute
metadata:
  name: example-app
  namespace: default  # Change to your app namespace
spec:
  # Reference the external gateway in istio-system
  parentRefs:
    - name: external
      namespace: istio-system
      sectionName: http  # or https for TLS traffic

  # Define the hostnames this route matches
  hostnames:
    - "example.yourdomain.com"
    - "www.example.yourdomain.com"

  # Define routing rules
  rules:
    - matches:
        - path:
            type: PathPrefix
            value: /
      backendRefs:
        - name: example-service  # Your service name
          port: 80  # Your service port
          weight: 100

      # Optional: Add filters for request/response modification
      # filters:
      #   - type: RequestHeaderModifier
      #     requestHeaderModifier:
      #       add:
      #         - name: X-Custom-Header
      #           value: "custom-value"
